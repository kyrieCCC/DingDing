<template>
  <div>
    <div class="header">
      <div class="header_left">
        <img src="@/imgs/logo.png" class="header_left-img" />
        <div class="header_left_font">Home Page</div>
        <div class="header_left_font">Produce List</div>
        <div class="header_left_font">Contact Us</div>
      </div>
      <div class="header_middle"></div>
      <div class="header_right">
        <div class="seacher-item-img">
          <svg
            t="1668666474379"
            class="icon"
            viewBox="0 0 1024 1024"
            version="1.1"
            xmlns="http://www.w3.org/2000/svg"
            p-id="1119"
            width="20"
            height="20"
          >
            <path
              d="M986.530909 1022.370909c-8.843636 0-17.92-3.490909-24.669091-10.24L710.749091 761.018182c-13.730909-13.730909-13.730909-35.84 0-49.338182s35.84-13.730909 49.338182 0l251.112727 251.112727c13.730909 13.730909 13.730909 35.84 0 49.338182-6.749091 6.749091-15.592727 10.24-24.669091 10.24z"
              p-id="1120"
            ></path>
            <path
              d="M442.181818 69.818182c205.265455 0 372.363636 167.098182 372.363637 372.363636s-167.098182 372.363636-372.363637 372.363637S69.818182 647.447273 69.818182 442.181818 236.916364 69.818182 442.181818 69.818182m0-69.818182C198.050909 0 0 198.050909 0 442.181818s198.050909 442.181818 442.181818 442.181818 442.181818-198.050909 442.181818-442.181818S686.312727 0 442.181818 0z"
              p-id="1121"
            ></path>
          </svg>
        </div>
        <div class="package-item-img">
          <svg
            t="1668666589370"
            class="icon"
            viewBox="0 0 1024 1024"
            version="1.1"
            xmlns="http://www.w3.org/2000/svg"
            p-id="1330"
            width="20"
            height="20"
          >
            <path
              d="M485.701818 547.84c-10.705455 0-21.410909-4.887273-28.16-14.429091L390.749091 442.181818a34.978909 34.978909 0 0 1 56.552727-41.192727l66.56 91.229091a34.978909 34.978909 0 0 1-28.16 55.621818z"
              p-id="1331"
            ></path>
            <path
              d="M544.116364 547.84c-7.214545 0-14.429091-2.094545-20.48-6.749091-15.592727-11.403636-19.083636-33.28-7.68-48.872727l66.56-91.229091A34.978909 34.978909 0 0 1 639.069091 442.181818l-66.56 91.229091c-6.981818 9.309091-17.687273 14.429091-28.392727 14.429091z"
              p-id="1332"
            ></path>
            <path
              d="M649.309091 612.072727H374.690909c-19.316364 0-34.909091-15.592727-34.909091-34.909091s15.592727-34.909091 34.909091-34.909091h274.618182c19.316364 0 34.909091 15.592727 34.909091 34.909091s-15.592727 34.909091-34.909091 34.909091zM649.309091 710.050909H374.690909c-19.316364 0-34.909091-15.592727-34.909091-34.909091s15.592727-34.909091 34.909091-34.909091h274.618182c19.316364 0 34.909091 15.592727 34.909091 34.909091s-15.592727 34.909091-34.909091 34.909091z"
              p-id="1333"
            ></path>
            <path
              d="M512 847.36c-19.316364 0-34.909091-15.592727-34.909091-34.909091V537.6c0-19.316364 15.592727-34.909091 34.909091-34.909091s34.909091 15.592727 34.909091 34.909091v274.850909c0 19.316364-15.592727 34.909091-34.909091 34.909091z"
              p-id="1334"
            ></path>
            <path
              d="M884.363636 92.858182v843.869091H139.636364V92.858182h744.727272m11.636364-69.818182h-768C95.883636 23.04 69.818182 48.872727 69.818182 81.221818v867.141818a58.181818 58.181818 0 0 0 58.181818 58.181819h768a58.181818 58.181818 0 0 0 58.181818-58.181819V81.221818c0-32.349091-26.065455-58.181818-58.181818-58.181818z"
              p-id="1335"
            ></path>
            <path
              d="M512 303.476364L121.483636 100.770909 153.6 38.865455 512 224.814545l359.330909-185.94909 32.116364 61.905454z"
              p-id="1336"
            ></path>
          </svg>
        </div>
      </div>
    </div>
    <div class="body-container">
      <div>
        <img class="product-img" src="https://cdn.shopifycdn.net/s/files/1/0676/0723/2799/products/O1CN01BeiA941XfbYTbR9NZ__4071272951-0-cib.jpg?v=1667996650&width=533" />
      </div>
      <div class="product-discript">
        <div class="product-introduce">
          <div class="product-introduce-font">
            <img style="height: 20px" src="@/imgs/hot.png" />
            好看的衣服好看的衣服好看的衣服好看的衣服好看的衣服好看的衣服好看的衣服
          </div>
          <div class="dingding-hotpay">
            <svg
              t="1670831024241"
              class="icon"
              viewBox="0 0 1024 1024"
              version="1.1"
              xmlns="http://www.w3.org/2000/svg"
              p-id="5205"
              width="32"
              height="32"
            >
              <path
                d="M176.8 983.2c-4.8 0-9.6-1.6-13.6-5.6-8.8-7.2-9.6-20.8-2.4-30.4l80-93.6-4.8-4C135.2 768.8 77.6 648 77.6 519.2c0-49.6 8.8-98.4 24.8-144.8l1.6-4-3.2-2.4C62.4 338.4 40 293.6 40 245.6c0-84.8 68.8-153.6 153.6-153.6 42.4 0 81.6 16.8 110.4 46.4l3.2 3.2 4-1.6c60-31.2 127.2-47.2 195.2-47.2 68.8 0 138.4 17.6 200.8 50.4l4 2.4 3.2-3.2c28.8-31.2 69.6-49.6 112.8-49.6 84.8 0 153.6 68.8 153.6 153.6 0 51.2-25.6 99.2-68 128l-4 2.4 1.6 4c15.2 44.8 23.2 91.2 23.2 140 0 129.6-57.6 250.4-158.4 331.2l-4.8 3.2 78.4 93.6c4 4 5.6 9.6 4.8 15.2-0.8 5.6-3.2 11.2-8 15.2-4 3.2-8.8 4.8-14.4 4.8-6.4 0-12-2.4-16.8-7.2l-81.6-96-4 2.4c-68 41.6-145.6 64-224.8 64-80 0-157.6-22.4-224.8-64l-4-2.4-82.4 96.8c-4 2.4-10.4 5.6-16 5.6zM505.6 134.4c-212 0-384 172-384 384s172 384 384 384 384-172 384-384-172.8-384-384-384z m320 0c-27.2 0-52.8 9.6-72.8 28l-5.6 4.8 5.6 4c56.8 40.8 103.2 95.2 134.4 157.6l3.2 6.4 5.6-4.8c25.6-20.8 40-52 40-84.8 0-61.6-49.6-111.2-110.4-111.2z m-631.2 0c-60.8 0-110.4 49.6-110.4 110.4 0 30.4 12 58.4 33.6 79.2l5.6 5.6 3.2-6.4c32-61.6 79.2-116 136.8-155.2l6.4-4-5.6-4.8c-20-16-44.8-24.8-69.6-24.8z"
                fill="#ffffff"
                p-id="5206"
              ></path>
              <path
                d="M504.8 540c-12 0-21.6-9.6-21.6-21.6V269.6c0-12 9.6-21.6 21.6-21.6s21.6 9.6 21.6 21.6v227.2h212c12 0 21.6 9.6 21.6 21.6 0 12-9.6 21.6-21.6 21.6H504.8z"
                fill="#ffffff"
                p-id="5207"
              ></path>
            </svg>
            <span style="margin-left: 10px; margin-right: 50px">
              DingDing秒杀正在火热进行中。。。
            </span>
            <span style="color: aliceblue;">
              <el-statistic ref="statistic" format="HH:mm:ss" :value="deadline4" time-indices style="color: rgb(230, 224, 224)"> </el-statistic>
            </span>
          </div>
          <div class="product-money">
            <div>
              <span class="money-discript"> 秒杀价: </span>
              <span class="price-money"> $ {{ prices }}USD </span>
            </div>
          </div>
          <div class="product-money">
            <div>
              <span class="money-discript"> 优惠券: </span>
              <span class="price-lessmoney"> 暂无 </span>
            </div>
          </div>
          <div style="margin-left: 10px">
            <span class="money-discript"> 选择尺码大小 </span>
            <span class="chooise-for-size" id="L" @click="setBorder('L')">
              L小
            </span>
            <span class="chooise-for-size" id="XL" @click="setBorder('XL')">
              XL中
            </span>
            <span class="chooise-for-size" id="XXL" @click="setBorder('XXL')">
              XXL大
            </span>
            <span class="chooise-for-size" id="XXXL" @click="setBorder('XXXL')">
              XXXL加大
            </span>
          </div>
          <div style="margin: 15px 10px">
            <span class="money-discript"> 选择分期支付 </span>
            <span
              class="chooise-for-date-pay1"
              id="120*3"
              @click="setBorder('120*3')"
            >
              120*3期
            </span>
            <span
              class="chooise-for-date-pay1"
              id="48*6"
              @click="setBorder('48*6')"
            >
              48*6期
            </span>
            <span
              class="chooise-for-date-pay1"
              id="22*12"
              @click="setBorder('22*12')"
            >
              22*12期
            </span>
            <span
              class="chooise-for-date-pay1"
              id="32*7"
              @click="setBorder('32*7')"
            >
              7*32期
            </span>
          </div>
          <span class="money-discript" style="margin-left: 10px;"> 选择购买数量 </span>
          <el-input-number v-model="num" :min="1" :max="10" label="描述文字"></el-input-number>
        </div>
        <div class="pay-foritem">
          <div style="margin: 15px 10px">
            <div class="chooise-pay-content">
              <div class="money-discript-ways">选择支付方式</div>
              <div
                class="chooise-for-date-pay2"
                id="wechat"
                @click="setBorder('wechat')"
              >
                <img src="@/imgs/wechat-pay.png" alt="" />
              </div>
              <div
                class="chooise-for-date-pay2"
                id="zhifubao"
                @click="setBorder('zhifubao')"
              >
                <img src="@/imgs/zhifubao.png" alt="" />
              </div>
              <div
                class="chooise-for-date-pay2"
                id="jingdong"
                @click="setBorder('jingdong')"
              >
                <img src="@/imgs/jingdong.png" alt="" />
              </div>
              <div
                class="chooise-for-date-pay2"
                id="yinlian"
                @click="setBorder('yinlian')"
              >
                <img src="@/imgs/yinlian.png" alt="" />
              </div>
            </div>
            <div class="pay-buttom">
              <el-button type="danger" @click="addToShippingCar">+ 加入购物车</el-button>
              <el-button type="success" @click="dialogVisible = true"
                >购买</el-button
              >
              <el-dialog
                title="提示"
                :visible.sync="dialogVisible"
                width="30%"
                :before-close="handleClose"
              >
                <span>您确认要购买该商品吗</span>
                <span slot="footer" class="dialog-footer">
                  <el-button @click="dialogVisible = false">取 消</el-button>
                  <el-button type="primary" @click="pay_button_yes"
                    >确 定</el-button
                  >
                </span>
              </el-dialog>
              <el-dialog    
                title="提示"
                :visible.sync="centerDialogVisible"
                width="30%"
                center
              >
                <img src="@/imgs/code.jpg" style="width: 300px;height: 300px;" center/>
                <!-- <span slot="footer" class="dialog-footer">
                  <el-button @click="centerDialogVisible = false"
                    >取 消</el-button
                  >
                  <el-button type="primary" @click="centerDialogVisible = false"
                    >确 定</el-button
                  >
                </span> -->
              </el-dialog>
              <div class="number-tips">剩余数量: {{ number }}</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
import http from "@/service/index";
import { payProduct } from "@/service/update.js"
import { insertShoppingcarData } from "@/service/insert.js";
export default {
  name: "Item9Product",
  props: ["username"],
  data: function () {
    return {
      // username: '',
      center: true,
      centerDialogVisible: false,
      num: 1,
      ID: "p1009",
      prices: "",
      number: "",
      dialogVisible: false,
      format:'HH小时:mm:ss:SSS',
      deadline: Date.now() + 1000 * 60 * 60 * 24 * 2,
      deadline2: Date.now() + 1000 * 60 * 60 * 8,
      deadline3: Date.now() + 1000 *  60 *30,
      deadline4: Date.now() + (new Date().setHours(23,59,59)-Date.now()) ,
    };
  },
  async mounted() {
    await this.getProductInfo(this.ID, this.number);
    // this.username = sessionStorage.getItem('username')
  },
  methods: {
    async addToShippingCar() {
      // EventBus.$emit('shippingCar', [this.ID, this.prices, this.num])
      const addRes = await insertShoppingcarData(this.ID, this.username, this.prices, this.number, this.num)
      this.$notify({
        title: "成功",
        message: "加入购物车成功",
        type: "success",
      });
      setTimeout(() => {
        location.reload()
      }, 2000)
      // this.$router.push('/home')
    },
    hilarity() {
      this.$notify({
          title: '提示',
          message: '时间已到，你可知寸金难买寸光阴？',
          duration: 0
        });
    },
    async getProductInfo(ID, number) {
      const res = await http.get(`/product`, { params: { ID, number } });
      // console.log(res.data.data[0])
      this.prices = res.data.data[0].prices;
      this.number = res.data.data[0].number;
      // console.log(this.prices);
    },
    async pay_button_yes() {
      this.centerDialogVisible = true
      await setTimeout(() => {
        this.centerDialogVisible = false
      }, 5000)
      console.log(this.ID, this.number, this.num)
      await payProduct(this.ID, this.number, this.num, this.username)
      this.dialogVisible = false
      this.$notify({
          title: '成功',
          message: '购买成功',
          type: 'success'
      });
      setTimeout(() => {
        location.reload();
      }, 2000)
    },
    handleClose(done) {
      this.$confirm("确认关闭？")
        .then((_) => {
          done();
        })
        .catch((_) => {});
    },
    setBorder(id) {
      document.getElementById(id).style.border = "1px solid red";
    },
  },
};
</script>

<style lang="scss">
* {
  padding: 0;
  margin: 0;
}
.container {
  height: 100%;
}
.header {
  background-color: #fff;
  border-bottom: #d6d6d6 solid 1px;
  height: 55px;
  display: flex;
  margin: 16px 32px;
}
.header_left {
  margin-left: 100px;
  width: 400px;
  display: flex;
  justify-content: center;
  align-items: center;
}
.header_left_font {
  margin-left: 25px;
  color: #121212bf;
  font-size: 13px;
  font-family: Assistant, sans-serif;
}
.header_left_font:hover {
  cursor: pointer;
  color: #121212;
  text-decoration: underline;
}
.header_middle {
  display: flex;
  flex-grow: 1;
}
.header_left-img {
  width: 50px;
  height: 50px;
}
.header_right {
  width: 600px;
  display: flex;
  justify-content: center;
  align-items: center;
}
.package-item-img {
  margin-left: 43px;
}
.body-container {
  margin: 50px 160px;
  display: flex;
}
.product-img {
  width: 400px;
  height: 500px;
}
.product-discript {
  margin: auto 100px;
}
.product-introduce {
  width: 500px;
  height: 330px;
  /* border: 1px solid aqua; */
}
.pay-foritem {
  width: 500px;
  height: 200px;
  /* border: 1px solid aqua; */
}
.product-introduce-font {
  font-size: 18px;
  color: #1c1c1cbf;
  font-family: Arial, "microsoft yahei";
  line-height: 20px;
}
.dingding-hotpay {
  background-color: rgb(247, 91, 91);
  font-size: 18px;
  color: rgb(230, 224, 224);
  display: flex;
  align-items: center;
  height: 35px;
  margin-top: 15px;
}
.product-money {
  margin: 10px;
}
.money-discript {
  margin-right: 15px;
  font-size: 13px;
  color: #999;
}
.price-money {
  color: #e4393c;
  font-size: 22px;
  margin-left: 5px;
}
.price-lessmoney {
  font-size: 13px;
  color: rgb(106, 104, 104);
}
.chooise-for-size {
  display: inline-block;
  width: 80px;
  height: 40px;
  border: 1px solid rgb(197, 189, 189);
  line-height: 40px;
  text-align: center;
  margin-right: 12px;
}
.chooise-for-size:hover {
  cursor: pointer;
}
.chooise-for-date-pay1 {
  display: inline-block;
  justify-content: center;
  align-items: center;
  width: 80px;
  height: 30px;
  border: 1px solid rgb(197, 189, 189);
  line-height: 30px;
  text-align: center;
  margin-right: 12px;
}
.chooise-for-date-pay1:hover {
  cursor: pointer;
}
.chooise-for-date-pay2 {
  /* display: inline-block; */
  width: 120px;
  height: 50px;
  border: 1px solid rgb(197, 189, 189);
  margin: 5px 15px;
}
.chooise-for-date-pay2:hover {
  cursor: pointer;
}
.chooise-for-date-pay2 > img {
  width: 120px;
  height: 50px;
}
.money-discript-ways {
  width: 80px;
  height: 50px;
  /* border: 1px solid rgb(197, 189, 189); */
  font-size: 13px;
  color: #999;
  line-height: 50px;
  text-align: start;
  margin-top: 5px;
}
.chooise-pay-content {
  display: flex;
  flex-wrap: wrap;
}
.pay-buttom {
  display: flex;
  justify-content: center;
  align-items: center;
  margin-top: 30px;
}
.number-tips {
  font-size: 12px;
  color: #999;
  margin-left: 20px;
}
.time{
  color: rgb(230, 224, 224);
}
</style>
