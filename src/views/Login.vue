<template>
  <div>
    <div class="head">
      <div class="head-content">
        <svg
          t="1670744202779"
          class="icon"
          viewBox="0 0 1024 1024"
          version="1.1"
          xmlns="http://www.w3.org/2000/svg"
          p-id="1967"
          width="48"
          height="48"
        >
          <path
            d="M617.952531 599.704351H510.805167V941.554513h122.453416V617.561912c2.551508-10.205034-5.102018-17.857561-15.306052-17.857561z m-45.920156 170.925081c0-7.653526 5.102018-10.205034 10.204035-10.205034s10.205034 5.103017 10.205034 10.205034v43.368648c0 7.653526-5.103017 10.205034-10.205034 10.205034s-10.204035-5.103017-10.204035-10.205034v-43.368648z"
            fill="#FFCC66"
            p-id="1968"
          ></path>
          <path
            d="M867.96238 525.718603L510.805167 181.316933v183.680624h45.920156c10.204035 0 17.857561 7.653526 17.857561 17.85856v91.840312c0 10.204035-7.653526 17.857561-17.857561 17.857561h-45.920156v107.147364h107.147364c10.204035 0 17.857561 7.653526 17.857561 17.857561V834.405151h244.907832V530.82062c-5.102018 0-7.652527 0.000999-12.755544-5.102017z"
            fill="#8BB9FF"
            p-id="1969"
          ></path>
          <path
            d="M388.350751 617.557916c0-10.205034 7.653526-17.85856 17.857561-17.85856h107.147364V492.551992h-45.920156c-10.204035 0-17.857561-7.652527-17.857561-17.857561v-91.840312c0-10.205034 7.653526-17.857561 17.857561-17.857561h45.920156V183.866443L156.198462 528.268113c-2.551508 2.551508-7.653526 5.102018-12.755543 5.102018v303.58453H388.350751V617.557916z"
            fill="#BCD6FF"
            p-id="1970"
            data-spm-anchor-id="a313x.7781069.0.i3"
            class="selected"
          ></path>
          <path
            d="M143.442919 834.404152v40.818139c0 35.716121 28.062595 63.777717 61.227208 63.777717h183.680624V831.853643H143.442919v2.550509z"
            fill="#ECF2FF"
            p-id="1971"
          ></path>
          <path
            d="M635.810092 941.552515h183.681623c33.164613 0 61.226209-28.061596 61.226209-63.777717v-40.818138H635.810092v104.595855z"
            fill="#BCD6FF"
            p-id="1972"
          ></path>
          <path
            d="M819.490716 211.931036c0-10.204035-7.653526-17.857561-17.857561-17.857561h-68.880734c-10.204035 0-17.857561 7.653526-17.857561 17.857561v81.636277l102.045347 99.493838V211.931036h2.550509z"
            fill="#FFCC66"
            p-id="1973"
          ></path>
          <path
            d="M406.209311 599.704351c-10.205034 0-17.85856 7.652527-17.85856 17.857561V941.554513h122.454416V599.704351H406.209311z"
            fill="#FBF585"
            p-id="1974"
          ></path>
          <path
            d="M556.725323 492.554989c10.204035 0 17.857561-7.653526 17.857561-17.857561v-91.840312c0-10.205034-7.653526-17.85856-17.857561-17.85856h-45.920156v127.556433h45.920156z"
            fill="#BCD6FF"
            p-id="1975"
          ></path>
          <path
            d="M452.129467 382.857116v91.840312c0 10.204035 7.652527 17.857561 17.857561 17.857561h45.920156V364.998556h-45.920156c-12.755543 0-17.857561 7.653526-17.857561 17.85856z"
            fill="#ECF2FF"
            p-id="1976"
          ></path>
          <path
            d="M582.23641 824.201116c5.102018 0 10.205034-5.102018 10.205034-10.204035V770.627434c0-7.653526-5.103017-10.204035-10.205034-10.204035s-10.204035 5.102018-10.204035 10.204035v43.369647c0 5.102018 5.102018 10.204035 10.204035 10.204035z"
            fill="#FF8A65"
            p-id="1977"
          ></path>
          <path
            d="M934.291606 461.942884l-375.015774-359.708722c-25.511087-25.511087-66.329225-25.511087-91.840312 0L89.869237 461.942884c-10.204035 10.205034-10.204035 25.511087 0 35.716121l28.062595 28.062595c10.204035 10.204035 25.511087 10.204035 35.715122 0L510.805167 183.870439 867.96238 525.7216c10.204035 10.204035 25.511087 10.204035 35.715122 0l28.062596-28.062595c12.755543-7.653526 12.755543-25.511087 2.551508-35.716121z"
            fill="#5895ED"
            p-id="1978"
          ></path>
          <path
            d="M513.355676 81.825093c-17.857561 0-33.164613 5.103017-45.920156 17.85856L89.869237 461.942884c-10.204035 10.205034-10.204035 25.511087 0 35.716121l28.062595 28.061596c10.204035 10.205034 25.511087 10.205034 35.715122 0L510.805167 183.870439V81.825093h2.550509z"
            fill="#8BB9FF"
            p-id="1979"
          ></path>
        </svg>
      </div>
      <div>
        <div style="font-size: 24px">Sign in to DingDing</div>
      </div>
    </div>
    <div class="form">
      <div class="form-layout">
        <div class="form-header">
          <span class="form-content">Username or email address</span>
          <span>
            <el-dropdown trigger="click" @command="chargeL">
              <span class="el-dropdown-link">
                语言<i class="el-icon-arrow-down el-icon--right"></i>
              </span>
              <el-dropdown-menu slot="dropdown">
                <el-dropdown-item icon="el-icon-plus" command="en"
                  >English</el-dropdown-item
                >
                <el-dropdown-item icon="el-icon-circle-plus" command="zh"
                  >中文</el-dropdown-item
                >
                <el-dropdown-item
                  icon="el-icon-circle-plus-outline"
                  command="ja"
                  >小日文</el-dropdown-item
                >
              </el-dropdown-menu>
            </el-dropdown>
          </span>
        </div>
        <div>
          <el-input v-model="username" />
        </div>
        <div class="form-content-psw">
          <span>Password</span>
          <span class="forget-content">
            <a href="#">Forgot password?</a>
          </span>
        </div>
        <div>
          <el-input v-model="password" show-password />
        </div>
        <div class="botton">
          <el-button size="mini" round @click="loginByAdmin">我是管理员</el-button>
          <el-button @click="loginEvent">{{
            $t("message.login")
          }}</el-button>
          <el-button size="mini" round @click="loginByVisitor">游客进入</el-button>    
        </div>
      </div>
    </div>
    <div class="help">
      <div class="help-content">
        New to DingDing?
        <a @click="toRegister" class="a-color"> Create an account .</a>
      </div>
    </div>
    <div>
      <div class="foot-content">
        <a href="#" class="foot-content2">Terms</a>
        <a href="#" class="foot-content2">Privacy</a>
        <a href="#" class="foot-content2">Security</a>
        <span class="foot-content2">Contact DingDing</span>
      </div>
    </div>
  </div>
</template>

<script>
import router from "@/router";
// import EventBus from "../bus/index.js"
import { EventBus } from "../bus/index"
import { loginService } from "../service/login.js"
// import store from "@/store/index.js";

export default {
  name: "Login",
  data: function () {
    return {
      
      username: "",
      password: "",
    //   loginData: store,
    };
  },
  methods: {
    chargeL(command) {
      this.$i18n.locale = command;
    },


    //这是原始的登录方法，这个方法不需要去后端找数据
    // loginEventPass() {
    //   if (this.username === "admin" && this.password === "123456") {
    //     this.$notify({
    //       title: "成功",
    //       message: "登陆成功",
    //       type: "success",
    //     });
    //     this.$router.push("/home");
    //   }
    // },

    async loginEvent() {
      this.$bus.$emit('userdata', 'hello world')
      const res = await loginService(this.username, this.password);
      if (!res.data.success) { //通过success这个属性确定是否存在该数据
        this.$notify({
          title: "提示",
          message: "登陆失败,请检查用户名与密码是否正确",
          duration: 0,
        });
        return;
      }
      sessionStorage.setItem('username', this.username)
      this.$notify({
        title: "成功",
        message: "页面跳转成功",
        type: "success",
      });
      // this.$emit('userdata', {data: this.username})
      // EventBus.$emit('userdata', 'hello world')
      console.log('success')
      this.$router.push("/home");
      
    },
    loginByVisitor() {
      this.$notify({
        title: "成功",
        message: "您当前浏览的是游客界面",
        type: "success",
      });
      this.$router.push("/visitorhome");
    },
    loginByAdmin() {
      this.$router.push("/adminlogin")
    },
    toRegister() {
      this.$router.push("/register")
    }
  },
};
</script>

<style lang="scss">
html,
body {
  width: 100%;
  height: 100%;
}

.head {
  display: flex;
  flex-direction: column;
  align-items: center;
}

.head-content {
  margin: 20px;
}

.help {
  display: flex;
  justify-content: center;
}

a {
  text-decoration: none;
  color: #58b6f2;
}

.help-content {
  width: 308px;
  border: 1px solid #d0d7de;
  border-radius: 6px;
  padding: 16px;
  margin: 16px;
  text-align: center;
  font-size: 14px;
}

.a-color:hover {
  cursor: pointer;
  border-bottom: 1px solid #acd5f1;
}

.foot-content {
  display: flex;
  justify-content: center;
  margin: 40px;
}

.foot-content2 {
  padding: 10px;
  font-size: 12px;
}

.form-layout {
  width: 308px;
  height: 216px;
  border: 1px solid #d0d7de;
  padding: 16px;
  border-radius: 6px;
  margin-top: 16px;
}
.form {
  display: flex;
  justify-content: center;
}
.form-content {
  font-size: 14px;
  margin-bottom: 8px;
  text-align: left;
}
.form-content-psw {
  font-size: 14px;
  margin-bottom: 8px;
  margin-top: 35px;
  text-align: left;
}
.botton {
  margin-top: 12px;
  display: flex;
  justify-content: center;
  align-items: center;
}
.forget-content {
  float: right;
}
.el-dropdown-link {
  margin-left: 60px;
}
.el-dropdown-link:hover {
  cursor: pointer;
}
.form-header {
  margin-bottom: 10px;
}
</style>
